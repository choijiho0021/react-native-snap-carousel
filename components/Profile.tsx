import {RootState} from '@reduxjs/toolkit';
import React, {memo} from 'react';
import {StyleSheet, View} from 'react-native';
import {connect} from 'react-redux';
import Svg, {Circle, G, Mask, Path} from 'react-native-svg';
import AppUserPic from '@/components/AppUserPic';
import {colors} from '@/constants/Colors';
import {appStyles} from '@/constants/Styles';
import utils from '@/redux/api/utils';
import {AccountModelState} from '@/redux/modules/account';
import AppText from './AppText';
import {isDeviceSize} from '@/constants/SliderEntry.style';

const ProfileImg = () => (
  <Svg
    width="76"
    height="76"
    viewBox="0 0 76 76"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <Circle cx="38" cy="38" r="38" fill="#C6DCFF" />
    <Mask
      id="mask0_4079_22115"
      style="mask-type:luminance"
      maskUnits="userSpaceOnUse"
      x="0"
      y="0"
      width="76"
      height="76">
      <Circle cx="38" cy="38" r="38" fill="white" />
    </Mask>
    <G mask="url(#mask0_4079_22115)">
      <Path
        d="M31.7197 16.6708C30.6973 16.0644 28.3317 13.2284 28.2954 11.7562C28.2788 11.1025 28.6914 10.5032 29.2183 10.2839C29.7694 10.0537 31.0207 9.9266 32.791 12.241"
        fill="#FFDC00"
      />
      <Path
        d="M57.9966 16.458C57.3944 12.4848 57.2291 12.0658 55.7504 11.4805C54.82 11.1575 53.895 11.2606 53.1079 11.5064C53.6933 11.165 54.836 11.0954 55.2479 10.624C55.9342 9.83681 55.6274 8.55435 54.9121 7.58676C54.6923 7.28933 53.7759 7.39997 52.9793 7.1895C51.9675 6.92093 51.0261 6.35295 50.6106 6.21947C48.4621 5.52449 46.9069 5.85234 45.486 6.61965C45.3094 5.95161 44.8568 5.60544 44.8568 5.60544C42.8467 4.21638 39.3558 5.96689 39.3558 5.96689C32.9041 9.00241 30.8495 14.9217 30.8495 14.9217C28.1002 21.509 30.3608 28.0615 38.7885 31.3993C46.3074 34.374 53.2856 33.2373 57.0772 25.3161C58.4951 22.0895 58.267 18.267 57.9945 16.4581L57.9966 16.458Z"
        fill="#FFDC00"
      />
      <Path
        d="M42.716 26.2842C42.8474 27.0839 43.2914 27.9282 44.0402 28.1763C44.4683 28.3178 44.9342 28.2337 45.3081 27.8888C45.6821 27.544 46.1619 26.709 45.6736 25.3095"
        stroke="black"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M12.4319 49.5786C14.3425 50.5256 16.5764 52.1949 18.8726 56.2536C20.3931 58.941 21.1782 61.2365 22.1151 63.7256C22.4868 64.7105 22.8718 65.6722 22.9818 66.7286L19.5959 71.6274C19.5959 71.6274 15.9649 70.5579 10.8281 67.261C7.62225 65.2036 5.67218 63.7764 4.09643 61.8729C2.34702 59.7589 1.39933 56.3697 2.61662 53.3213C3.55565 50.9697 5.50632 49.1837 7.84654 48.8193C9.65487 48.5372 11.0297 48.8796 12.4315 49.5744L12.4319 49.5786Z"
        fill="#5AA2FF"
      />
      <Path
        d="M52.4006 86.901C56.1086 84.6394 54.7953 73.7117 54.6844 73.4689C51.4479 66.4337 43.658 64.6077 36.3213 64.3632C36.3213 64.3632 25.4522 62.7593 20.3017 66.4778C18.716 67.6239 15.3047 72.4479 15.4787 74.9418C18.3316 88.6656 43.4279 92.133 52.4006 86.901Z"
        fill="#529EFF"
      />
      <Path
        d="M46.2304 25.3215C46.2304 25.3215 44.7872 20.3237 40.7625 16.6723C40.1664 16.1317 39.2757 16.0685 38.6107 16.5203C34.1118 19.5686 31.9774 24.313 31.9774 24.313L38.9012 27.6828L46.2305 25.3233L46.2304 25.3215Z"
        fill="white"
      />
      <Path
        d="M45.3664 32.1653C47.3862 32.1423 49.3081 30.3738 49.4367 28.2035C49.5429 26.4235 48.3966 24.9943 46.6368 24.7025C45.6432 24.5378 44.8825 24.8599 44.0502 25.2368C43.4465 25.5111 42.7382 25.2362 42.4946 24.7299C41.8154 23.3142 40.8594 22.3675 39.2818 22.2564C37.7041 22.1454 36.6231 22.9468 35.7524 24.2532C35.4405 24.7208 34.7006 24.8922 34.1415 24.5369C33.3721 24.047 32.6624 23.6193 31.6561 23.6435C29.8735 23.6849 28.5367 24.939 28.3915 26.7144C28.2147 28.8807 29.8667 30.9029 31.8634 31.2095L45.3646 32.1654L45.3664 32.1653Z"
        fill="#529EFF"
      />
      <Path
        d="M39.0144 26.0589C21.8783 24.8462 10.6548 35.9902 9.79305 48.1471C8.8822 61.0003 20.4588 68.4143 35.9377 69.5105C51.4166 70.6067 63.9221 64.8973 64.8311 52.0443C65.6928 39.8856 56.1506 27.2716 39.0144 26.0589Z"
        fill="#529EFF"
      />
      <Path
        d="M28.1218 50.6296C29.015 50.5673 29.6886 49.7927 29.6263 48.8994C29.564 48.0062 28.7893 47.3327 27.8961 47.395C27.0029 47.4573 26.3293 48.2319 26.3916 49.1251C26.454 50.0183 27.2286 50.6919 28.1218 50.6296Z"
        fill="black"
      />
      <Path
        d="M18.5228 53.6835C20.3133 53.5586 21.6635 52.0059 21.5385 50.2154C21.4136 48.4249 19.8609 47.0747 18.0704 47.1996C16.2799 47.3245 14.9297 48.8773 15.0546 50.6677C15.1795 52.4582 16.7323 53.8084 18.5228 53.6835Z"
        fill="#8DBFFF"
      />
      <Path
        d="M48.5079 56.3823C50.2984 56.2574 51.6486 54.7046 51.5237 52.9141C51.3988 51.1236 49.846 49.7734 48.0555 49.8984C46.265 50.0233 44.9148 51.576 45.0398 53.3665C45.1647 55.157 46.7174 56.5072 48.5079 56.3823Z"
        fill="#8DBFFF"
      />
      <Path
        d="M39.5001 45.2462C40.3519 45.0688 41.5296 44.5445 41.3887 43.5814C41.2935 43.1145 40.7846 42.8183 40.2867 42.7609C39.436 42.6636 38.5812 42.8504 37.8594 43.3062C37.5135 43.5256 37.1123 43.9019 37.1296 44.5456C37.3076 45.5134 38.6498 45.4179 39.502 45.2461"
        fill="#1169D2"
      />
      <Path
        d="M28.3451 44.2426C27.5391 43.9156 26.4733 43.1903 26.7829 42.2676C26.9603 41.8259 27.5139 41.6252 28.0136 41.6566C28.867 41.7132 29.6753 42.0492 30.3054 42.6281C30.6067 42.9056 30.9341 43.3471 30.803 43.9772C30.4545 44.897 29.1525 44.564 28.3451 44.2426Z"
        fill="#1169D2"
      />
      <Path
        d="M41.7624 55.114C41.0098 53.2005 38.611 53.0472 37.6349 53.1853C36.8923 53.2906 36.4083 53.4054 35.5208 53.4415C34.6683 53.4771 33.9234 53.5217 33.1408 53.451C32.3583 53.3803 31.6348 53.2041 30.7999 53.0173C29.9333 52.8235 29.4772 52.625 28.7641 52.3873C27.8285 52.0766 25.4396 51.7993 24.3583 53.5478C24.047 54.0504 23.9704 54.8813 23.986 55.21C24.0548 56.7512 24.758 60.5181 32.442 61.2092C40.1242 61.9004 41.4904 58.3207 41.8332 56.8153C41.9065 56.4933 41.9794 55.6627 41.7641 55.1121L41.7624 55.114Z"
        fill="#AA2222"
      />
      <Path
        d="M41.7621 55.114C41.0095 53.2005 38.6108 53.0472 37.6346 53.1853C36.892 53.2906 36.4081 53.4054 35.5206 53.4415C34.6681 53.4771 33.9231 53.5217 33.1406 53.451C32.3581 53.3803 31.6345 53.2041 30.7997 53.0173C29.933 52.8235 29.477 52.625 28.7639 52.3873C27.8283 52.0766 25.4393 51.7993 24.3581 53.5478C24.0467 54.0504 23.9702 54.8813 23.9858 55.21C24.0546 56.7512 24.7578 60.5181 32.4418 61.2092C40.124 61.9004 41.4902 58.3207 41.8329 56.8153C41.9063 56.4933 41.9791 55.6627 41.7638 55.1121L41.7621 55.114Z"
        fill="#AF0404"
      />
      <Path
        d="M30.2848 52.8893C29.906 52.7853 29.6007 52.678 29.2714 52.5622C29.1116 52.506 28.9461 52.4477 28.7638 52.387C28.3583 52.2524 27.6799 52.124 26.9532 52.1641C26.9809 52.4737 27.1208 53.4337 27.8127 54.2572C28.1461 54.6522 28.6658 54.7321 29.1571 54.3532C29.5392 54.0576 29.9737 53.6467 30.2848 52.8893Z"
        fill="white"
      />
      <Path
        d="M36.0485 53.4075C36.4354 53.3731 36.752 53.3225 37.0917 53.2683C37.2628 53.2409 37.4398 53.2127 37.6346 53.1851C38.0577 53.1252 38.7481 53.1201 39.4559 53.2893C39.3729 53.5908 39.0642 54.5088 38.2371 55.1938C37.8381 55.5238 37.312 55.5089 36.8965 55.0478C36.5732 54.6897 36.2203 54.2078 36.0485 53.4075Z"
        fill="white"
      />
      <Path
        d="M41.0621 58.623C37.3341 56.8362 32.872 56.4176 32.872 56.4176L32.8717 56.4139C32.8717 56.4139 28.4065 56.0292 24.4197 57.1224C25.1579 58.7875 27.1351 60.7317 32.4417 61.209C37.7437 61.686 40.0372 60.1287 41.0621 58.623Z"
        fill="#FF6A63"
      />
      <Path
        d="M35.9397 69.5107C25.7582 70.221 9.36406 62.9536 9.78969 50.8739"
        stroke="#3373DB"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M20.879 66.1383C19.4523 67.2403 17.5963 69.3747 16.3088 72.4718"
        stroke="#3373DB"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M50.3595 62.1906C49.4905 64.9537 48.3308 66.9748 47.1916 70.0277C46.159 72.79 49.0727 77.0127 51.9565 76.6972C59.9205 75.8248 70.1307 63.493 64.5819 55.1791C57.6153 48.2725 51.4654 58.6739 50.3595 62.1906Z"
        fill="#529EFF"
      />
      <Path
        d="M64.3113 54.9688C58.0687 49.8596 51.3931 55.9486 50.4836 62.3043C50.1767 64.4487 49.7424 65.595 49 66.4487"
        stroke="#3373DB"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M37.2097 50.5025C37.2097 50.5025 38.4439 49.6259 40.2694 49.9353"
        stroke="black"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M47.7152 21.3061C46.6887 21.9058 43.061 22.5976 41.7562 21.9148C41.1766 21.612 40.8529 20.9603 40.9169 20.3933C40.9831 19.7997 41.4793 18.644 44.362 18.2195"
        fill="#FFDC00"
      />
      <Path
        d="M44.002 14.9235C44.002 14.9235 43.5947 15.2721 42.91 15.2819C42.5948 15.2849 42.1933 15.2062 41.7808 15.0382C41.3685 14.8725 41.1845 14.7169 40.9604 14.4954C40.4739 14.0148 40.4225 13.4824 40.4225 13.4824"
        stroke="#EA5B54"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M44.9148 12.5728C44.9148 12.5728 46.1392 12.2099 47.4873 12.6684M41.3892 11.1896C41.2218 10.6606 40.8333 9.85058 40 9.46289"
        stroke="black"
        strokeWidth="1.01098"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
      <Path
        d="M47.7152 21.3061C46.6887 21.9058 43.061 22.5976 41.7562 21.9148C41.1766 21.612 40.8529 20.9603 40.9169 20.3933C40.9831 19.7997 41.4793 18.644 44.362 18.2195"
        stroke="#F4A32C"
        strokeLinecap="round"
      />
    </G>
  </Svg>
);

const styles = StyleSheet.create({
  container: {
    flexDirection: 'row',
    marginLeft: 20,
    height: 76,
    marginBottom: 30,
  },
  photo: {
    alignSelf: 'center',
  },
  label: {
    ...appStyles.medium16,
    fontSize: isDeviceSize('medium') ? 16 : 18,
    marginHorizontal: 20,
    lineHeight: isDeviceSize('medium') ? 22 : 24,
    color: colors.warmGrey,
    marginBottom: 4,
  },
  value: {
    ...appStyles.bold20Text,
    fontSize: isDeviceSize('medium') ? 20 : 22,
    marginLeft: 20,
    maxWidth: '100%',
    lineHeight: isDeviceSize('medium') ? 24 : 26,
    color: colors.black,
    marginRight: 20,
    marginBottom: 8,
  },
  userPicture: {
    width: 76,
    height: 76,
    borderRadius: 76 / 2,
    borderWidth: 1,
    borderColor: colors.whitefour,
  },
});

type ProfileProps = {
  account: AccountModelState;
  mobile?: string;
  email?: string;
  userPictureUrl?: string;
  onChangePhoto?: () => void;
};

const Profile: React.FC<ProfileProps> = ({
  account: {
    mobile: accountMobile,
    email: accountEmail,
    userPictureUrl: accountUserPictureUrl,
  },
  mobile,
  email,
  userPictureUrl,
  onChangePhoto = () => {},
}) => {
  return (
    <View style={styles.container}>
      <View style={styles.photo}>
        <AppUserPic
          url={userPictureUrl || accountUserPictureUrl}
          icon={<ProfileImg />}
          style={styles.userPicture}
          isAbsolutePath={userPictureUrl !== undefined}
          onPress={onChangePhoto}
        />
      </View>
      <View style={{flex: 3, justifyContent: 'center'}}>
        <AppText style={styles.value} numberOfLines={1} ellipsizeMode="tail">
          {email || accountEmail || ''}
        </AppText>
        <AppText style={styles.label}>
          {utils.toPhoneNumber(mobile || accountMobile)}
        </AppText>
      </View>
    </View>
  );
};

export default connect(({account}: RootState) => ({account}))(memo(Profile));
